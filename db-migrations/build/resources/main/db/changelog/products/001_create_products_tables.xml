<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
            http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.29.xsd">

    <changeSet id="001_create_products_table" author="admin">
        <createTable tableName="products">
            <column name="id" type="SERIAL">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="TEXT"/>
            <column name="price" type="NUMERIC(10,2)">
                <constraints nullable="false"/>
            </column>
            <column name="image_url" type="VARCHAR(255)"/>
            <column name="category_id" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP"/>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP"/>
        </createTable>

        <createTable tableName="categories">
            <column name="id" type="SERIAL">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="VARCHAR(100)">
                <constraints unique="true" nullable="false"/>
            </column>
        </createTable>

        <createIndex tableName="products" indexName="idx_products_name">
            <column name="name"/>
        </createIndex>

        <createIndex tableName="products" indexName="idx_products_price">
            <column name="price"/>
        </createIndex>
    </changeSet>

    <changeSet id="002_insert_test_products" author="test">
        <insert tableName="categories">
            <column name="id" value="1"/>
            <column name="name" value="Смартфоны"/>
        </insert>
        <insert tableName="categories">
            <column name="id" value="2"/>
            <column name="name" value="Планшеты"/>
        </insert>
        <insert tableName="categories">
            <column name="id" value="3"/>
            <column name="name" value="Ноутбуки"/>
        </insert>
        <insert tableName="categories">
            <column name="id" value="4"/>
            <column name="name" value="Телевизоры"/>
        </insert>
        <insert tableName="categories">
            <column name="id" value="5"/>
            <column name="name" value="Смарт-часы"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="1"/>
            <column name="name" value="Apple Смартфон iPhone 16 Pro, eSIM+SIM 8/256 ГБ"/>
            <column name="description" value="Смартфон Apple iPhone 16 Pro в черном цвете оснащен экраном 6.3 дюйма с разрешением 2622x1206 точек и AMOLED-матрицей..."/>
            <column name="price" value="120000"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-p/wc1000/7411792921.jpg"/>
            <column name="category_id" value="1"/>
            <column name="created_at" value="2025-03-17T10:00:00"/>
            <column name="updated_at" value="2025-03-17T10:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="2"/>
            <column name="name" value="Samsung Galaxy S24 Ultra 12/256 ГБ"/>
            <column name="description" value="Флагман Samsung с Dynamic AMOLED 2X дисплеем 6.8 дюйма, частотой 120 Гц и разрешением 3088x1440. Камера 200 МП, Snapdragon 8 Gen 3, корпус из титана."/>
            <column name="price" value="115000"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-9/wc1000/7302893193.jpg"/>
            <column name="category_id" value="1"/>
            <column name="created_at" value="2025-03-18T11:00:00"/>
            <column name="updated_at" value="2025-03-18T11:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="3"/>
            <column name="name" value="Xiaomi 14 Ultra 16/512 ГБ"/>
            <column name="description" value="Премиум смартфон с дисплеем LTPO AMOLED 6.73 дюйма, камерой Leica, Snapdragon 8 Gen 3, корпусом из керамики и зарядкой 90 Вт."/>
            <column name="price" value="89990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-2/wc1000/7204773062.jpg"/>
            <column name="category_id" value="1"/>
            <column name="created_at" value="2025-03-18T12:00:00"/>
            <column name="updated_at" value="2025-03-18T12:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="4"/>
            <column name="name" value="Google Pixel 8 Pro 12/256 ГБ"/>
            <column name="description" value="Смартфон от Google с OLED-дисплеем 6.7 дюйма, чипом Tensor G3, чистым Android и выдающейся камерой с AI-функциями."/>
            <column name="price" value="99990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-m/wc1000/6741841306.jpg"/>
            <column name="category_id" value="1"/>
            <column name="created_at" value="2025-03-19T09:30:00"/>
            <column name="updated_at" value="2025-03-19T09:30:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="5"/>
            <column name="name" value="OnePlus 12 16/512 ГБ"/>
            <column name="description" value="Флагман OnePlus с дисплеем 6.82 дюйма, частотой 120 Гц, Snapdragon 8 Gen 3, аккумулятором 5400 мАч и быстрой зарядкой 100 Вт."/>
            <column name="price" value="79990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-6/wc1000/7139928174.jpg"/>
            <column name="category_id" value="1"/>
            <column name="created_at" value="2025-03-19T10:00:00"/>
            <column name="updated_at" value="2025-03-19T10:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="6"/>
            <column name="name" value="Apple iPad Pro 11 (2024) 256 ГБ Wi-Fi"/>
            <column name="description" value="iPad Pro с чипом M3, дисплеем Liquid Retina 11 дюймов, поддержкой Apple Pencil Pro и Face ID. Отлично подходит для творчества и работы."/>
            <column name="price" value="110000"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-1/wc1000/7470862561.jpg"/>
            <column name="category_id" value="2"/>
            <column name="created_at" value="2025-03-20T10:00:00"/>
            <column name="updated_at" value="2025-03-20T10:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="7"/>
            <column name="name" value="Samsung Galaxy Tab S9 Ultra 12/256 ГБ Wi-Fi"/>
            <column name="description" value="Планшет с AMOLED-экраном 14.6 дюйма, влагозащитой IP68, чипом Snapdragon 8 Gen 2 и стилусом S Pen в комплекте."/>
            <column name="price" value="99990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-q/wc1000/7219099562.jpg"/>
            <column name="category_id" value="2"/>
            <column name="created_at" value="2025-03-20T10:30:00"/>
            <column name="updated_at" value="2025-03-20T10:30:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="8"/>
            <column name="name" value="Xiaomi Pad 6 8/256 ГБ Wi-Fi"/>
            <column name="description" value="Планшет с экраном 11 дюймов 144 Гц, процессором Snapdragon 870 и металлическим корпусом. Отличное соотношение цены и качества."/>
            <column name="price" value="27990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-9/wc1000/7068080133.jpg"/>
            <column name="category_id" value="2"/>
            <column name="created_at" value="2025-03-20T11:00:00"/>
            <column name="updated_at" value="2025-03-20T11:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="9"/>
            <column name="name" value="Lenovo Tab P12 Pro 8/256 ГБ Wi-Fi"/>
            <column name="description" value="Планшет с AMOLED-дисплеем 12.6 дюйма, 4 динамиками JBL, Snapdragon 870 и стилусом. Идеален для мультимедиа и заметок."/>
            <column name="price" value="49990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-6/wc1000/7278167082.jpg"/>
            <column name="category_id" value="2"/>
            <column name="created_at" value="2025-03-20T11:30:00"/>
            <column name="updated_at" value="2025-03-20T11:30:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="10"/>
            <column name="name" value="Huawei MatePad Pro 13.2 12/256 ГБ Wi-Fi"/>
            <column name="description" value="Планшет с OLED-дисплеем 13.2 дюйма, тонкими рамками, чипом Kirin 9000S и поддержкой стилуса M-Pencil. Ультралегкий и мощный."/>
            <column name="price" value="87990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-q/wc1000/7169788970.jpg"/>
            <column name="category_id" value="2"/>
            <column name="created_at" value="2025-03-20T12:00:00"/>
            <column name="updated_at" value="2025-03-20T12:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="11"/>
            <column name="name" value="Apple MacBook Pro 14 (2023) M3 Pro 18/512 ГБ"/>
            <column name="description" value="Мощный ноутбук с дисплеем Liquid Retina XDR 14.2 дюйма, чипом Apple M3 Pro, корпусом из алюминия и временем автономной работы до 18 часов."/>
            <column name="price" value="210000"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-m/wc1000/7296048982.jpg"/>
            <column name="category_id" value="3"/>
            <column name="created_at" value="2025-03-21T10:00:00"/>
            <column name="updated_at" value="2025-03-21T10:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="12"/>
            <column name="name" value="ASUS ROG Zephyrus G14 (2024) Ryzen 9 / RTX 4070"/>
            <column name="description" value="Игровой ноутбук с дисплеем 14 дюймов 165 Гц, видеокартой RTX 4070, процессором Ryzen 9 7940HS и лёгким корпусом из магниевого сплава."/>
            <column name="price" value="179990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-r/wc1000/7154908359.jpg"/>
            <column name="category_id" value="3"/>
            <column name="created_at" value="2025-03-21T10:30:00"/>
            <column name="updated_at" value="2025-03-21T10:30:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="13"/>
            <column name="name" value="Lenovo Legion 5 Pro 16ACH6H RTX 3060"/>
            <column name="description" value="16-дюймовый QHD IPS экран, Ryzen 7 5800H, видеокарта RTX 3060, высокая производительность и отличное охлаждение."/>
            <column name="price" value="124990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-k/wc1000/7168012100.jpg"/>
            <column name="category_id" value="3"/>
            <column name="created_at" value="2025-03-21T11:00:00"/>
            <column name="updated_at" value="2025-03-21T11:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="14"/>
            <column name="name" value="HP Spectre x360 14 i7 Evo 16/512 ГБ"/>
            <column name="description" value="Премиум ультрабук-трансформер с сенсорным OLED-дисплеем, процессором Intel Core i7, Windows 11 и стилусом в комплекте."/>
            <column name="price" value="135000"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-8/wc1000/7427041136.jpg"/>
            <column name="category_id" value="3"/>
            <column name="created_at" value="2025-03-21T11:30:00"/>
            <column name="updated_at" value="2025-03-21T11:30:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="15"/>
            <column name="name" value="Huawei MateBook 14s 2023 i7 13/512 ГБ"/>
            <column name="description" value="Компактный ноутбук с IPS-дисплеем 2.5K 90 Гц, Intel Core i7-13700H, алюминиевым корпусом и продолжительной автономной работой."/>
            <column name="price" value="89990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-x/wc1000/7338829677.jpg"/>
            <column name="category_id" value="3"/>
            <column name="created_at" value="2025-03-21T12:00:00"/>
            <column name="updated_at" value="2025-03-21T12:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="16"/>
            <column name="name" value="Samsung Neo QLED 65 4K QE65QN90C"/>
            <column name="description" value="Премиальный телевизор с Mini LED-подсветкой, разрешением 4K UHD, частотой 120 Гц, технологиями Quantum HDR 32x и Dolby Atmos."/>
            <column name="price" value="189990"/>
            <column name="image_url" value="https://ir.ozone.ru/s3/multimedia-1-9/wc1000/7418159937.jpg"/>
            <column name="category_id" value="4"/>
            <column name="created_at" value="2025-03-22T10:00:00"/>
            <column name="updated_at" value="2025-03-22T10:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="17"/>
            <column name="name" value="LG OLED C3 55 4K"/>
            <column name="description" value="OLED-телевизор с безрамочным дизайном, поддержкой Dolby Vision, HDMI 2.1, G-Sync, VRR и webOS для умного ТВ."/>
            <column name="price" value="159990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-h/wc1000/7096789949.jpg"/>
            <column name="category_id" value="4"/>
            <column name="created_at" value="2025-03-22T10:30:00"/>
            <column name="updated_at" value="2025-03-22T10:30:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="18"/>
            <column name="name" value="Sony Bravia XR-65X90L 4K HDR"/>
            <column name="description" value="Телевизор с 65-дюймовым Full Array LED-дисплеем, Cognitive Processor XR, поддержкой Google TV, Dolby Vision и 120 Гц."/>
            <column name="price" value="144990"/>
            <column name="image_url" value="https://ir.ozone.ru/s3/multimedia-1-f/wc1000/7059918687.jpg"/>
            <column name="category_id" value="4"/>
            <column name="created_at" value="2025-03-22T11:00:00"/>
            <column name="updated_at" value="2025-03-22T11:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="19"/>
            <column name="name" value="Hisense ULED 55U7KQ 4K Mini LED"/>
            <column name="description" value="55-дюймовый Mini LED телевизор с матрицей 120 Гц, поддержкой HDR10+, Dolby Vision и звуком DTS Virtual:X."/>
            <column name="price" value="74990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-n/wc1000/7106570843.jpg"/>
            <column name="category_id" value="4"/>
            <column name="created_at" value="2025-03-22T11:30:00"/>
            <column name="updated_at" value="2025-03-22T11:30:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="20"/>
            <column name="name" value="Xiaomi TV A2 50 4K Smart TV"/>
            <column name="description" value="Телевизор с 4K UHD разрешением, Android TV, поддержкой Dolby Audio, безрамочным дизайном и пультом с голосовым управлением."/>
            <column name="price" value="34990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-p/wc1000/7114187365.jpg"/>
            <column name="category_id" value="4"/>
            <column name="created_at" value="2025-03-22T12:00:00"/>
            <column name="updated_at" value="2025-03-22T12:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="21"/>
            <column name="name" value="Apple Watch Series 9 45 мм GPS"/>
            <column name="description" value="Умные часы Apple с дисплеем Always-On Retina, функцией двойного касания, датчиком кислорода в крови, ЭКГ и корпусом из алюминия."/>
            <column name="price" value="44990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-y/wc1000/7161403954.jpg"/>
            <column name="category_id" value="5"/>
            <column name="created_at" value="2025-03-23T10:00:00"/>
            <column name="updated_at" value="2025-03-23T10:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="22"/>
            <column name="name" value="Samsung Galaxy Watch6 Classic 47 мм LTE"/>
            <column name="description" value="Классические умные часы с вращающимся безелем, дисплеем Super AMOLED, функциями EKG, пульсометр и измерением давления."/>
            <column name="price" value="37990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-j/wc1000/7349596039.jpg"/>
            <column name="category_id" value="5"/>
            <column name="created_at" value="2025-03-23T10:30:00"/>
            <column name="updated_at" value="2025-03-23T10:30:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="23"/>
            <column name="name" value="Huawei Watch GT 4 46 мм"/>
            <column name="description" value="Стильные смарт-часы с AMOLED-экраном, более 100 режимов тренировок, двухдиапазонным GPS и автономностью до 14 дней."/>
            <column name="price" value="19990"/>
            <column name="image_url" value="https://ir.ozone.ru/s3/multimedia-1-l/wc1000/6955572681.jpg"/>
            <column name="category_id" value="5"/>
            <column name="created_at" value="2025-03-23T11:00:00"/>
            <column name="updated_at" value="2025-03-23T11:00:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="24"/>
            <column name="name" value="Amazfit GTR 4"/>
            <column name="description" value="Смарт-часы с поддержкой звонков по Bluetooth, GPS, AMOLED-дисплеем 1.43 дюйма и автономностью до 14 дней."/>
            <column name="price" value="13990"/>
            <column name="image_url" value="https://ir-9.ozone.ru/s3/multimedia-1-q/wc1000/7432490798.jpg"/>
            <column name="category_id" value="5"/>
            <column name="created_at" value="2025-03-23T11:30:00"/>
            <column name="updated_at" value="2025-03-23T11:30:00"/>
        </insert>

        <insert tableName="products">
            <column name="id" value="25"/>
            <column name="name" value="Redmi Watch 4"/>
            <column name="description" value="Смарт-часы с большим AMOLED-дисплеем 1.97 дюйма, металлическим корпусом, защитой 5ATM и автономностью до 20 дней."/>
            <column name="price" value="5990"/>
            <column name="image_url" value="https://ir.ozone.ru/s3/multimedia-1-n/wc1000/6961570499.jpg"/>
            <column name="category_id" value="5"/>
            <column name="created_at" value="2025-03-23T12:00:00"/>
            <column name="updated_at" value="2025-03-23T12:00:00"/>
        </insert>
    </changeSet>

    <changeSet id="003_add_updated_at_trigger" author="admin">
        <sql dbms="postgresql" splitStatements="false">
            CREATE OR REPLACE FUNCTION update_updated_at_column()
        RETURNS TRIGGER AS $$
            BEGIN
            NEW.updated_at = CURRENT_TIMESTAMP;
            RETURN NEW;
            END;
        $$ LANGUAGE plpgsql;
        </sql>
        <sql dbms="postgresql" splitStatements="false">
            CREATE TRIGGER update_products_updated_at
                BEFORE UPDATE ON products
                FOR EACH ROW
                EXECUTE FUNCTION update_updated_at_column();
        </sql>
    </changeSet>
</databaseChangeLog>